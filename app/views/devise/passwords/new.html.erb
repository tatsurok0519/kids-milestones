<div class="card" style="max-width:28rem;margin:0 auto;">
  <h2 class="h2">パスワード再発行</h2>
  <p style="color:#7a6b5a;margin:.25rem 0 1rem;">
    登録したメールアドレスに、パスワード再設定用のリンクをお送りします。
  </p>

  <%= form_for(
        resource,
        as: resource_name,
        url: password_path(resource_name),
        html: { method: :post, data: { turbo: false } }   # ← Turbo無効（redirect_to(nil)対策）
      ) do |f| %>

    <%= render "devise/shared/error_messages", resource: resource %>

    <%# ===== メールアドレス ===== %>
    <% e_id    = "#{f.object_name}_email" %>
    <% e_hint  = "#{e_id}_hint" %>
    <% e_err   = resource.errors[:email].first %>
    <% e_errid = "#{e_id}_error" %>

    <div class="field">
      <%= f.label :email, "メールアドレス", class: "label" %>
      <%= f.email_field :email,
            id: e_id, class: "input",
            autofocus: true, autocomplete: "email", inputmode: "email", required: true,
            placeholder: "example@example.com",
            "aria-describedby": [e_hint, (e_err ? e_errid : nil)].compact.join(" "),
            "aria-invalid": e_err.present? %>
      <p id="<%= e_hint %>" class="text-muted" style="font-size:.85rem;margin:.3rem 0 0;">
        入力したアドレス宛に再設定用リンクを送ります。
      </p>
      <% if e_err.present? %>
        <p id="<%= e_errid %>" style="color:#9b2c10;font-size:.85rem;margin:.25rem 0 0;">
          <%= e_err %>
        </p>
      <% end %>
    </div>

    <div class="actions" style="margin-top:1rem;">
      <%= f.submit "再設定メールを送信", class: "btn btn-primary" %>
    </div>
  <% end %>

  <div style="margin-top:1rem; display:flex; gap:.5rem; flex-wrap:wrap;">
    <%= link_to "ログインに戻る", new_session_path(resource_name), class: "btn btn-secondary" %>
    <%= link_to "新規登録はこちら", new_registration_path(resource_name) %>
  </div>
</div>