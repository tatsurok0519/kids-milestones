<% ordered      = Reward.order(Arel.sql("CASE kind WHEN 'medal' THEN 0 ELSE 1 END"), :threshold).to_a %>
<% unlocked_ids = @reward_unlock_ids || [] %>
<% items        = ordered.select { |rw| unlocked_ids.include?(rw.id) } %>

<%# 仕様：未解放は非表示／左寄せ／折返しなし（アニメの光が切れないよう overflow:visible） %>
<% if items.any? %>
  <div class="rewards-row"
       style="display:flex; align-items:center; gap:.5rem; flex-wrap:nowrap; white-space:nowrap; overflow:visible;">
    <% items.each do |rw| %>
      <% size =
        if rw.kind == 'medal'
          rw.tier == 'bronze' ? 48 : 56
        else
          { 'bronze'=>64, 'silver'=>72, 'gold'=>80 }[rw.tier]
        end %>
      <span id="reward_icon_<%= rw.id %>" class="reward-icon"
            style="width:<%= size %>px; height:<%= size %>px; display:inline-flex; align-items:center; justify-content:center; flex:0 0 auto;">
        <%= image_tag rw.icon_path, alt: "", style: "max-width:100%; max-height:100%; object-fit:contain; display:block;" %>
      </span>
    <% end %>
  </div>
<% end %>