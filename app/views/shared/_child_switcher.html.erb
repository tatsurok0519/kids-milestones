<div class="card child-switcher">
  <!-- 横スクロールのカード切替（PC/タブレット向け） -->
  <div class="row" role="tablist" aria-label="お子さま切替"
       style="display:flex; gap:.5rem; overflow-x:auto; padding-bottom:.25rem;">

    <% @children.each do |kid| %>
      <% active = (@selected_child&.id == kid.id) %>
      <%= link_to dashboard_path(child_id: kid.id),
                  class: "kid-chip #{'is-active' if active}",
                  aria: { current: (active ? "true" : nil) },
                  # ★ activeのときは視覚的に強調（背景/枠/リング）
                  style: "display:inline-flex;align-items:center;gap:.6rem;padding:.55rem .8rem;border:1px solid var(--border);border-radius:.8rem;background:#fff;text-decoration:none;color:var(--text);white-space:nowrap;#{'background:#fff7ed;border-color:#fb923c;box-shadow:0 0 0 4px rgba(251,146,60,.25);' if active}" do %>

        <% if kid.photo.attached? %>
          <%= image_tag kid.photo_thumb, alt: "#{kid.name}の写真",
                style: "width:40px;height:40px;object-fit:cover;border-radius:50%;" %>
        <% end %>

        <span style="font-weight:700;"><%= kid.name %></span>

        <% if kid.respond_to?(:age_years_and_months) %>
          <span class="pill" style="margin-left:.15rem;"><%= kid.age_years_and_months %></span>
        <% end %>
      <% end %>
    <% end %>

    <!-- 追加ボタン -->
    <%= link_to new_child_path,
          class: "kid-chip",
          style: "display:inline-flex;align-items:center;gap:.6rem;padding:.55rem .8rem;border:1px dashed var(--border);border-radius:.8rem;background:#fff;text-decoration:none;color:var(--text);" do %>
      + 子どもを追加
    <% end %>
  </div>

  <!-- せまい画面向けドロップダウン -->
  <div class="dropdown-sm" style="margin-top:.5rem;">
    <%= form_with url: dashboard_path, method: :get, local: true do %>
      <label class="label" for="child_id">お子さまを選択</label>
      <%= select_tag :child_id,
            options_from_collection_for_select(@children, :id, :name, @selected_child&.id),
            class: "input",
            onchange: "this.form.submit()" %>
    <% end %>
  </div>
</div>