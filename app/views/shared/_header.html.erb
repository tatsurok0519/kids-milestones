<header class="header-bar">
  <div class="container header-inner">
    <div class="brand">
      <%= asset_img "illustrations/sun.png",
            alt: "", width: 90, height: 90,
            decoding: "async", fetchpriority: "high",
            class: "brand-logo" %>
      <h1 class="brand-title">
        <%= link_to "こどもすくすくカード",
                    (respond_to?(:root_path) ? root_path : dashboard_path),
                    style: "text-decoration:none; color:inherit;" %>
      </h1>
    </div>

    <%# ---- 現在ページの強調用（コントローラ名で判定） ---- %>
    <% current_ctrl = controller_name %>
    <% dash_class = "btn btn-secondary" + (current_ctrl == "dashboard" ? " is-active" : "") %>
    <% tasks_class = "btn btn-secondary" + (current_ctrl == "tasks"     ? " is-active" : "") %>
    <% consl_class = "btn btn-secondary" + (current_ctrl == "consults"  ? " is-active" : "") %>
    <% mypg_class  = "btn btn-secondary" + ((current_ctrl == "registrations" && action_name == "edit") ? " is-active" : "") %>

    <%# === ナビ（常時表示） === %>
    <nav id="main-nav" class="main-nav">
      <%= link_to "メイン", dashboard_path,
                  class: dash_class,
                  "aria-current": (current_ctrl=="dashboard" ? "page" : nil) %>

      <%= link_to "できるかな", tasks_path(age_band: "all"),
                  class: tasks_class,
                  "aria-current": (current_ctrl=="tasks" ? "page" : nil) %>

      <%= link_to "そうだん", consult_path,
                  class: consl_class,
                  "aria-current": (current_ctrl=="consults" ? "page" : nil) %>

      <%= link_to "マイページ", edit_user_registration_path, class: mypg_class %>

      <% if user_signed_in? %>
        <%= button_to "ログアウト",
              destroy_user_session_path,
              method: :delete,
              class: "btn btn-ghost",
              form: { data: { turbo: true } } %>
      <% end %>
    </nav>
  </div>
</header>

<style>
/* ナビの「今いる場所」強調（ナビ内だけに限定） */
.main-nav .btn.is-active { border-color:#60a5fa; background:#eff6ff; }
/* スクリーンリーダー用（他で使っていれば残してOK） */
.sr-only {
  position:absolute !important; width:1px; height:1px; padding:0; margin:-1px;
  overflow:hidden; clip:rect(0,0,1px,1px); white-space:nowrap; border:0;
}
</style>