<div class="container main">
  <div class="card">
    <h2 class="h2" style="margin-top:0;">子ども一覧</h2>

    <div class="actions" style="margin:.5rem 0 1rem; display:flex; gap:.5rem; flex-wrap:wrap;">
      <%= link_to "子どもを追加", new_child_path, class:"btn btn-primary" %>
      <%= link_to "マイページへ戻る", dashboard_path, class:"btn btn-secondary" %>
    </div>

    <% if @children.any? %>
      <div class="cards-grid">
        <% @children.each do |child| %>
          <div class="card" style="padding:1rem;">
            <div style="display:flex; gap:.75rem; align-items:center;">
              <% if child.photo.attached? %>
                <%= attachment_img child.photo,
                      variant: child.photo_thumb,
                      alt: "#{child.name}の写真", width: 72, height: 72,
                      style: "object-fit:cover;border-radius:.6rem;border:1px solid var(--border);" %>
              <% else %>
                <%= asset_img "illustrations/sun.png", alt: "", width: 72, height: 72,
                      style: "border-radius:.6rem;border:1px solid var(--border);background:#f3f4f6;" %>
              <% end %>

              <div style="min-width:0;">
                <div style="font-weight:700;"><%= child.name %></div>
                <div class="text-muted" style="font-size:.9rem;margin-top:.2rem;">
                  <%= child.age_label %> / <%= child.age_band_label %>
                </div>

                <div style="margin-top:.5rem; display:flex; gap:.5rem; flex-wrap:wrap;">
                  <%= link_to "編集", edit_child_path(child), class:"btn btn-secondary" %>
                  <%= button_to "削除する", child_path(child),
                        method: :delete,
                        form: { data: { turbo_confirm: "※削除すると 写真 と 達成履歴（花丸） も一緒に削除されます。復元はできません。よろしいですか？" } },
                        class: "btn btn-danger" %>
                </div>
              </div>
            </div>
          </div>
        <% end %>
      </div>
    <% else %>
      <p>登録された子どもはいません。</p>
    <% end %>
  </div>
</div>