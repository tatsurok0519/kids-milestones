<% working  = achievement&.working %>
<% achieved = achievement&.achieved %>

<%= turbo_frame_tag dom_id(milestone, :controls) do %>
  <%# 右上バッジ %>
  <% if working %>
    <%= asset_img "icons/try.png", alt:"", width:44, height:44,
          style:"position:absolute; top:8px; right:8px; pointer-events:none;" %>
  <% elsif achieved %>
    <%= asset_img "icons/hanamaru.png", alt:"", width:44, height:44,
          style:"position:absolute; top:8px; right:8px; pointer-events:none;" %>
  <% end %>

  <div style="margin-top:.6rem; display:flex; gap:.5rem; flex-wrap:wrap; align-items:center;">
    <%= button_to(
          achievements_upsert_path(
            milestone_id:    milestone.id,
            age_band:        params[:age_band],
            category:        params[:category],
            difficulty:      params[:difficulty],
            only_unachieved: params[:only_unachieved],
            page:            params[:page]
          ),
          params: { toggle: "working" },
          method: :post,
          form:   { data: { turbo: true, turbo_frame: dom_id(milestone, :controls) } },
          class:  "btn btn-secondary #{'is-active' if working}",
          aria:   { pressed: working ? "true" : "false" }
        ) do %>
      がんばり中
    <% end %>

    <%= button_to(
          achievements_upsert_path(
            milestone_id:    milestone.id,
            age_band:        params[:age_band],
            category:        params[:category],
            difficulty:      params[:difficulty],
            only_unachieved: params[:only_unachieved],
            page:            params[:page]
          ),
          params: { toggle: "achieved" },
          method: :post,
          form:   { data: { turbo: true, turbo_frame: dom_id(milestone, :controls) } },
          class:  "btn btn-primary #{'is-active' if achieved}",
          aria:   { pressed: achieved ? "true" : "false" }
        ) do %>
      できた！
    <% end %>
  </div>
<% end %>